<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>剪贴板历史</title>
  <style>
    :root{
      --mt-bg:#0f1113; --mt-fg:#e6e7ea; --mt-border:#3a3b41; --mt-panel:#2b2d31;
      --mt-scrollbar-track:#1c1e22; --mt-scrollbar-thumb:#3a3b41; --mt-scrollbar-thumb-hover:#4a4b51;
      --mt-tooltip-bg:#1c1f24; --mt-tooltip-fg:#e6e7ea; --mt-tooltip-border:#3a3b41; --mt-shadow:0 8px 24px rgba(0,0,0,0.45);
    }
    :root[data-theme="light"]{
      --mt-bg:#ffffff; --mt-panel:#ffffff; --mt-fg:#333333; --mt-border:#e5e7eb;
      --mt-scrollbar-track:#f3f4f6; --mt-scrollbar-thumb:#d1d5db; --mt-scrollbar-thumb-hover:#9ca3af;
      --mt-tooltip-bg:#ffffff; --mt-tooltip-fg:#333333; --mt-tooltip-border:#e5e7eb; --mt-shadow:0 8px 24px rgba(0,0,0,0.12);
    }
    * { box-sizing: border-box; }
    html, body { overflow-x: hidden; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; display: flex; height: 100vh; background: var(--mt-bg); color: var(--mt-fg); }
    .panel { flex: 1; display: flex; flex-direction: column; background: var(--mt-panel); }
    .toolbar { padding: 10px; border-bottom: 1px solid var(--mt-border); display: flex; gap: 8px; align-items: center; }
    .toolbar input { flex: 1; min-width: 0; padding: 8px; font-size: 14px; background: transparent; color: var(--mt-fg); border: 1px solid var(--mt-border); border-radius: 6px; outline: none; }
    .toolbar input:focus { border-color: var(--mt-primary); box-shadow: 0 0 0 2px color-mix(in oklab, var(--mt-primary) 25%, transparent); }
    .toolbar .right { display: flex; gap: 8px; align-items: center; }
    .icon-btn { display: inline-flex; align-items: center; justify-content: center; width: 28px; height: 28px; border: 1px solid var(--mt-border); border-radius: 999px; background: transparent; color: var(--mt-fg); cursor: pointer; }
    .icon-btn:hover { background: rgba(255,255,255,0.06); }
    .icon-btn.active { border-color: var(--mt-primary); color: var(--mt-primary); }
    .count { font-size: 12px; color: var(--mt-muted); min-width: 24px; text-align: right; }
    .list { flex: 1; overflow-y: auto; overflow-x: hidden; scrollbar-width: none; -ms-overflow-style: none; }
    .list::-webkit-scrollbar { width: 0; height: 0; }
    .item { position: relative; padding: 10px 10px 4px 10px; border-bottom: 1px solid var(--mt-border); display: grid; grid-template-columns: 48px 1fr; column-gap: 8px; row-gap: 1px; align-items: start; overflow: hidden; }
    .item pre { margin: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; min-width: 0; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size: 12px; color: var(--mt-fg); }
    .item pre.line { white-space: normal; display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; }
    .type { font-size: 12px; color: #888; text-align: center; }
    .actions { display: flex; gap: 6px; }
    .btn { padding: 6px 10px; font-size: 12px; border: 1px solid var(--mt-border); border-radius: 6px; background: transparent; color: var(--mt-fg); cursor: pointer; }
    .btn:hover { background: rgba(255,255,255,0.06); }
    .empty { color: #888; padding: 16px; }

    /* 全局滚动条（纵向/横向）主题适配 */
    ::-webkit-scrollbar { width: 10px; height: 10px; }
    ::-webkit-scrollbar-track { background: var(--mt-scrollbar-track); }
    ::-webkit-scrollbar-thumb { background: var(--mt-scrollbar-thumb); border-radius: 6px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--mt-scrollbar-thumb-hover); }
    ::-webkit-scrollbar-corner { background: var(--mt-panel); }

    /* 右键菜单 */
    .ctx-menu { position: fixed; z-index: 9999; min-width: 160px; background: var(--mt-panel); color: var(--mt-fg); border: 1px solid var(--mt-border); border-radius: 8px; box-shadow: var(--mt-shadow); padding: 6px; display: none; }
    .ctx-menu .menu-item { display: flex; align-items: center; gap: 8px; padding: 8px 10px; cursor: pointer; border-radius: 6px; }
    .ctx-menu .menu-item:hover { background: rgba(255,255,255,0.06); }
    .ctx-menu .menu-item svg { width: 16px; height: 16px; }

    /* 展开显示（在原文字处展开） */
    .item.expanded pre.line { display: block; -webkit-line-clamp: unset; line-clamp: unset; overflow: visible; white-space: pre-wrap; overflow-wrap: break-word; word-break: break-word; }
    .center-toggle { position: static; grid-column: 2 / 3; justify-self: center; margin-top: 0; margin-bottom: 0; background: transparent; border: none; color: var(--mt-muted); cursor: pointer; padding: 0; width: auto; height: auto; line-height: 0; display: inline-flex; align-items: center; justify-content: center; }
    .center-toggle:hover { color: var(--mt-primary); }
    .center-toggle svg { width: 22px; height: 22px; }
  </style>
  <script defer src="script.js"></script>
  <script>
    (async function(){
      try {
        const info = await window.MT.invoke('ui.getTheme');
        const eff = (info && (info.effective || (info.data && info.data.effective))) || 'light';
        const tokens = (info && (info.tokens || (info.data && info.data.tokens))) || null;
        const root = document.documentElement;
        if (eff === 'dark') root.setAttribute('data-theme', ''); else root.setAttribute('data-theme', 'light');

        function resolve(val, scope) {
          if (typeof val === 'string' && /^\{.+\}$/.test(val)) {
            const path = val.slice(1, -1).split('.');
            let cur = scope;
            for (const seg of path) { cur = cur && cur[seg]; }
            return resolve(cur, scope);
          }
          return val;
        }

        if (tokens) {
          const t = tokens[eff] || tokens.light;
          if (t && t.color) {
            const c = t.color;
            const comp = t.component || {};
            const sb = comp.scrollbar || {};
            const tip = comp.tooltip || {};
            const elev = t.elevation || {};

            root.style.setProperty('--mt-bg', resolve(c.bg, t));
            root.style.setProperty('--mt-panel', resolve(c.panel, t));
            root.style.setProperty('--mt-panel-2', resolve(c.panel2 || c.panel, t));
            root.style.setProperty('--mt-fg', resolve(c.fg, t));
            root.style.setProperty('--mt-muted', resolve(c.muted || '#9aa3b2', t));
            root.style.setProperty('--mt-border', resolve(c.border, t));
            root.style.setProperty('--mt-primary', resolve(c.primary, t));
            root.style.setProperty('--mt-on-primary', resolve(c.onPrimary || '#ffffff', t));
            root.style.setProperty('--mt-ok', resolve(c.ok || '#3cc86b', t));
            root.style.setProperty('--mt-warn', resolve(c.warn || '#ffb86c', t));
            root.style.setProperty('--mt-bad', resolve(c.bad || '#ff6b6b', t));

            root.style.setProperty('--mt-scrollbar-track', resolve(sb.track || 'transparent', t));
            root.style.setProperty('--mt-scrollbar-thumb', resolve(sb.thumb || '#999', t));
            root.style.setProperty('--mt-scrollbar-thumb-hover', resolve(sb.thumbHover || '#aaa', t));

            root.style.setProperty('--mt-tooltip-bg', resolve(tip.bg || c.panel, t));
            root.style.setProperty('--mt-tooltip-fg', resolve(tip.fg || c.fg, t));
            root.style.setProperty('--mt-tooltip-border', resolve(tip.border || c.border, t));

            root.style.setProperty('--mt-shadow-1', resolve(elev.surface || '0 6px 20px rgba(0,0,0,0.12)', t));
            root.style.setProperty('--mt-shadow-2', resolve(elev.overlay || '0 8px 24px rgba(0,0,0,0.12)', t));
            root.style.setProperty('--mt-shadow', resolve(elev.overlay || elev.surface || '0 8px 24px rgba(0,0,0,0.12)', t));
          }
        }
      } catch {}
    })();
  </script>
</head>
<body>
  <div class="panel">
    <div class="toolbar">
      <input id="q" placeholder="搜索剪贴板历史..." />
      <div class="right">
        <button id="toggleFav" class="icon-btn" title="切换收藏">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
          </svg>
        </button>
        <span id="count" class="count">0</span>
      </div>
    </div>
    <div id="list" class="list"></div>
  </div>
</body>
</html>


